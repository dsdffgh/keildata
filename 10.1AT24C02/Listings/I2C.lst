C51 COMPILER V9.60.7.0   I2C                                                               02/01/2023 12:06:33 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE I2C
OBJECT MODULE PLACED IN .\Objects\I2C.obj
COMPILER INVOKED BY: Z:\buyaobilian\keil_v5\C51\BIN\C51.EXE I2C.C OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Li
                    -stings\I2C.lst) TABS(2) OBJECT(.\Objects\I2C.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          sbit I2C_SCL = P2 ^ 1;
   4          sbit I2C_SDA = P2 ^ 0;
   5          
   6          /*
   7           *  @brief   I2C开始
   8           *  @param
   9           *  @retva
  10           */
  11          void I2C_Start()
  12          {
  13   1          I2C_SDA = 1;
  14   1          I2C_SCL = 1;
  15   1      
  16   1          I2C_SDA = 0;
  17   1          I2C_SCL = 0;
  18   1      }
  19          
  20          /*
  21           *  @brief   I2C停止
  22           *  @param
  23           *  @retva
  24           */
  25          void I2C_Stop()
  26          {
  27   1          I2C_SDA = 0;
  28   1          I2C_SCL = 1;
  29   1      
  30   1          I2C_SDA = 1;
  31   1      }
  32          
  33          /*
  34           *  @brief   I2C发送一个字节
  35           *  @param   Byte 要发送的字节
  36           *  @retva
  37           */
  38          void I2C_SendByte(unsigned char Byte)
  39          {
  40   1          unsigned char i;
  41   1          for (i = 0; i < 8 ;i++)
  42   1          {
  43   2              I2C_SDA = Byte & (0x80 >> i);
  44   2              I2C_SCL = 1;
  45   2              I2C_SCL = 0;
  46   2          }
  47   1      }
  48          
  49          /*
  50           *  @brief   I2C接受一个字节
  51           *  @param   无
  52           *  @retva   Byte 接收到的字节数据
  53           */
  54          unsigned char I2C_ReceiveByte()
C51 COMPILER V9.60.7.0   I2C                                                               02/01/2023 12:06:33 PAGE 2   

  55          {
  56   1          unsigned char i;
  57   1          unsigned char Byte = 0x00;
  58   1          I2C_SDA = 1;
  59   1          for (i = 0; i < 8 ;i++)
  60   1          {
  61   2              I2C_SCL = 1;
  62   2              if (I2C_SDA)
  63   2              {
  64   3                  Byte |= (0x80 >> i);
  65   3              }
  66   2              I2C_SCL = 0;
  67   2          }
  68   1          return Byte;
  69   1      }
  70          
  71          /*
  72           *  @brief   I2C发送应答
  73           *  @param   ACKBit 应答位，0为应答，1为非应答
  74           *  @retva
  75           */
  76          void I2C_SendACK(bit ACKBit)
  77          {
  78   1          I2C_SDA = ACKBit;
  79   1          I2C_SCL = 1;
  80   1          I2C_SCL = 0;
  81   1      }
  82          
  83          /*
  84           *  @brief   I2C接受应答位
  85           *  @param   无
  86           *  @retva   ACKBit 接收到的应答位
  87           */
  88          unsigned char I2C_ReceviceACK()
  89          {
  90   1          bit ACKBit;
  91   1          I2C_SDA = 1;
  92   1          I2C_SCL = 1;
  93   1          ACKBit = I2C_SDA;
  94   1          I2C_SCL = 0;
  95   1      
  96   1          return ACKBit;
  97   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    112    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       2
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
